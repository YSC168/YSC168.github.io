<html>

<head>
  <title>音乐歌单</title>
  <style type="text/css">
   
    
  </style>
   <meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">

<meta name="apple-mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-status-bar-style" content="black">

<meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="./css/style.min.css">
     <link rel="shortcut icon" href="favicon.ico" >
      
  
  <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script src="./js/jquery.min.js"></script>
    <script src="./js/aplayer.min.js"></script>
</head>

<body style="overflow:-Scroll;overflow-y:hidden">

<div style="margin-bottom: 80px;">
	<div class="aplayer" id="aplayer" style="max-width:400px;min-width: 400px;"></div>

      <div>
<footer>
            <p id="hitokoto">正在加载···</p>
            
        </footer>
      </div>
</div>
       
    
  <!-- After Footer Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.12.0/build/highlight.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@latest/dist/umd/popper-utils.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js"></script>
 
 
  <!-- Async Load Image -->
  <!-- 受制于 Hexo 的 Markdown 处理器， 无法全局应用，所以改成本页面专属 -->
  <script>
    function loadImage(DOM, src) {
      var ts = Date.now();
      var image = new Image();
      image.src = src;
      image.onload = function () {
        console.log('已成功加载图片， %s 耗时: %s ms', src, (Date.now() - ts));
        DOM.src = src;
      }
    }
    (function init() {
      // 先清理一波控制台
      console.clear()
      var images = document.images;
      // 加载首屏图片
      for (obj of images) {
        // 如果在可视区域并且还没被加载过
        if (obj.getBoundingClientRect().top < document.documentElement.clientHeight && !obj.isLoad) {
          obj.isLoad = true;
          // 先调用 HTML5 方法
          if (obj.dataset && obj.dataset.origin) {
            console.log('开始异步加载图片: %s', obj.dataset.origin);
            loadImage(obj, obj.dataset.origin);
          } else if (obj.getAttribute('data-origin')) {
            console.log('开始异步加载图片: %s', obj.getAttribute('data-origin'));
            loadImage(obj, obj.getAttribute('data-origin'));
          }
        } else {  // 假设图片标签在 HTML 中的顺序和实际页面中顺序一致
          break;
        }
      }
    })();
    function lazyload() {
      var lazy = 0;
      var images = document.images;
      for (obj of images) {
        if (obj.getBoundingClientRect().top - lazy < document.documentElement.clientHeight && !obj.isLoad) {
          obj.isLoad = true;
          if (obj.dataset && obj.dataset.origin) {
            console.log('开始异步加载图片: %s', obj.dataset.origin);
            loadImage(obj, obj.dataset.origin);
          } else if(obj.getAttribute('data-origin')){
            console.log('开始异步加载图片: %s', obj.getAttribute('data-origin'));
            loadImage(obj, obj.getAttribute('data-origin'));
          }
        }
      }
    }
    window.onscroll = function () {
      lazyload();
    };
    (function BindCardRedirect() {
      var cards = document.getElementsByClassName('card');
      for (obj of cards) {
        console.log(obj);
        if (obj.dataset) {
          // is HTML5
          obj.onclick = function () {
            window.open(this.dataset.href);
          }
        } else {
          obj.onclick = function () {
            window.open(this.getAttribute('data-href'));
          }
        }
      }
    })()

    // Load Player
    var songIds = [449818741,569214126,517543021,28461430,1321385655,36270426,468882985];
    fetch("https://api.a632079.me/nm/summary/" + songIds.join(',') + '?lyric=true&common=true')
      .then(function(res) {
        return res.json();
      })
      .then(function(data){
        var playlist = [];
        for(var i=0; i<data.songs.length; i++) {
          var song = {};
          song.name = data.songs[i].name;
          song.artist = data.songs[i].artists.join(' / ');
          song.url = data.songs[i].url;
          song.cover = data.songs[i].album.picture;
          song.lrc = data.songs[i].lyric.base;
          playlist.push(song);
        }
        window.player = new APlayer({
          container: document.getElementById('aplayer'),
          lrcType: 1,
          audio: playlist,
          autoplay: true
        });
      });
  </script>

  <!--底部音乐-->
<div class="aplayer-footer">
            <div class="ap-f" id="ap-f"></div>
            <script>
                $(function(){
                    $.ajax({
                        url:"https://api.fczbl.vip/163/?type=playlist&id=3778678",
                        success:function(e){
                            var a = new APlayer({
                                element:document.getElementById("ap-f"),
                                autoplay:false,
                                fixed:true,
                                loop:"all",
                                order:"list",
                                listFolded:true,
                                showlrc:3,
                                theme:"#e6d0b2",
                                listmaxheight:"200px",
                                music:eval(e)
                            });
                            window.aplayers || (window.aplayers = []),
                            window.aplayers.push(a)
                        }
                    })
                })
            </script>
        </div>
    </main>
    <script src="./js/main.js"></script>
</body>
</html>