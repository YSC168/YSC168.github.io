window.requestAnimationFrame=window.requestAnimationFrame||function(a){return setTimeout(a,1E3/60)};window.cancelAnimationFrame=window.cancelAnimationFrame||clearTimeout;
function FragmentBanner(a){this.whiteList="container controller size imgs size grid index fnTime boxTime type links titles intros".split(" ");this.container=".banner";this.controller={title:".title",intro:".intro",link:".link",view:".banner-view",btn:".banner-btn",num:".banner-number",progre:".banner-progres",text:".banner-text"};this.grid={line:5,list:10};this.size={width:1200,height:675};this.type=1;this.index=0;this.fnTime=5E3;this.boxTime=2E3;this.activeTime=new Date;for(var b=0,d=this.whiteList.length;b<
d;b++){var f=this.whiteList[b];void 0!=a[f]&&(this[f]=a[f])}for(var k in a);this.init()}
FragmentBanner.prototype={constructor:FragmentBanner,init:function(){if(this.container=document.querySelector(this.container))this.container.style.width=this.size.width+"px",this.container.style.height=this.size.height+"px";else return alert("\u83b7\u53d6banner\u5bb9\u5668\u5931\u8d25");this.elem={};for(var a in this.controller)if(this.elem[a]=this.container.querySelector(this.controller[a]),null==this.elem[a])return alert("\u83b7\u53d6"+a+"\u5bb9\u5668");a=this.size.width/this.grid.list;var b=this.size.height/
this.grid.line;this.elem.viewBox=[];for(var d=0,f=this.grid.line;d<f;d++)for(var k=0,g=this.grid.list;k<g;k++){var h=document.createElement("i");this.setCss(h,{width:a+"px",height:b+"px",left:0,top:0,opacity:1,backgroundImage:'url("'+this.imgs[this.index]+'")',backgroundSize:this.size.width+"px "+this.size.height+"px",backgroundPosition:a*-k+"px "+b*-d+"px"});this.elem.view.appendChild(h);this.elem.viewBox.push(h)}for(a=1;0<=a;a--)b=document.createElement("span"),a?b.innerHTML="&lt;":b.innerHTML=
"&gt;",b.setIndex=a,b.onclick=function(a){this.show({switch:!0,change:0==a.setIndex})}.bind(this,b),this.elem.btn.appendChild(b);a=0;for(b=this.imgs.length;a<b;a++)d=document.createElement("i"),d.setIndex=a,d.onclick=function(a){this.show({switch:!0,change:a.setIndex})}.bind(this,d),this.elem.num.appendChild(d);this.elem.numFind=this.elem.num.querySelectorAll("i");this.progre=[];for(a=1;0<=a;a--)b=document.createElement("i"),this.setCss(b,{width:0,backgroundColor:a?"#00c3ff":"#ffc300"}),this.elem.progre.appendChild(b),
this.progre.push(b);this.show();this.elem.numFind[this.index].className="on"},setIndex:function(){this.index%=this.imgs.length;this.index=0>this.index?this.imgs.length-1:this.index;this.elem.numFind[this.index].className="on"},getTypeTime:function(){var a=[];switch(this.type){case 1:a.push(this.boxTime/4+Math.random()*this.boxTime/4);a.push(a[0]);break;default:a.push([Math.random()*this.boxTime/5,this.boxTime/10*3]),a.push(a[0][0]+a[0][1])}return a},show:function(a){a=a||{};if(new Date>=this.activeTime){this.elem.numFind[this.index].className=
"";this.setCss(this.progre[1],{width:0}).anime(this.progre[1],{width:this.size.width},this.fnTime,function(){this.show({switch:!0,change:!0})}.bind(this));for(var b=!0,d=0,f=0,k=this.elem.viewBox.length;f<k;f++){var g=this.getTypeTime(),h=this.getTypeTime(),l=this.elem.viewBox[f];d=Math.max(d,g[1]+h[1]);this.anime(l,{left:Math.ceil(Math.random()*this.size.width*2-this.size.width),top:Math.ceil(Math.random()*this.size.height*2-this.size.height),opacity:0},g[0],function(d){a.switch&&b&&(/number/i.test(typeof a.change)?
this.index=a.change:a.change?++this.index:--this.index,this.setIndex(),this.elem.numFind[this.index].className="on",b=!1);this.setCss(d,{backgroundImage:'url("'+this.imgs[this.index]+'")'}).anime(d,{left:0,top:0,opacity:1},h[0])}.bind(this,l))}this.activeTime=new Date((new Date).getTime()+d);this.setCss(this.progre[0],{width:0}).anime(this.progre[0],{width:this.size.width},d)}},setCss:function(a,b){for(c in b)"opacity"==c?(a.style.opacity=c,a.style.filter="alpha(opacity="+100*b[c]+")"):a.style[c]=
b[c];return this},anime:function(a,b,d,f){function k(){var b=(new Date-m)/d;1<=b?b=1:a.timer=requestAnimationFrame(k);for(var e in h){var g=-l[e]*b*(b-2)+h[e];"opacity"==e?(a.style.opacity=g,a.style.filter="alpha(opacity="+100*g+")"):a.style[e]=g+"px"}1===b&&f&&f.call(a)}a.timer&&cancelAnimationFrame(a.timer);var g=a.currentStyle||getComputedStyle(a,null),h={},l={},e;for(e in b)b[e]!=parseFloat(g[e])&&(h[e]=parseFloat(g[e]),l[e]=b[e]-h[e]);var m=new Date;d instanceof Array?function n(){new Date-m>=
d[0]?(d=d[1],m=new Date,k()):a.timer=requestAnimationFrame(n)}():k()}};